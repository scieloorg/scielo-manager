{% extends dynamic_tpl %}
{% load i18n %}
{% load static %}


{% block content %}
<form id="article-form"
      method="post"
      action=""
      enctype="multipart/form-data">
  {% csrf_token %}

  <span class="label">{% trans "Titles" %}</span>
  <div class="well">

    <div class="control-group {% if forms.title_formset.errors %}error{% endif %}">
      <table id="titlesformset" class="table table-bordered table-striped">
        <tr>
          <td>{% trans 'Title' %}</td>
          <td>{% trans 'Language' %}</td>
        </tr>
        {% for title in forms.title_formset %}
        <tr>
          <td>{{ title.title }}</td>
          <td>{{ title.language }}</td>
        </tr>
        {% endfor %}
      </table>
      <p>
        {{ forms.title_formset.management_form }}
      </p>
    </div>

  </div>

  <div class="well">
    <label for="{{ forms.article_form.language.id }}">
      <span {% if 'required' in forms.article_form.language.flags %}class="req-field"{% endif %}>
        {{ forms.article_form.language.label }}
      </span>
    </label>
    <div class="control-group {% if forms.article_form.language.errors %}error{% endif %}">
      {{ forms.article_form.language }}
    </div>

    <label for="{{ forms.article_form.publication_city.id }}">
      <span {% if 'required' in forms.article_form.publication_city.flags %}class="req-field"{% endif %}>
        {{ forms.article_form.publication_city.label }}
      </span>
    </label>
    <div class="control-group {% if forms.article_form.publication_city.errors %}error{% endif %}">
      {{ forms.article_form.publication_city }}
    </div>

    <label for="{{ forms.article_form.publication_state.id }}">
      <span {% if 'required' in forms.article_form.publication_state.flags %}class="req-field"{% endif %}>
        {{ forms.article_form.publication_state.label }}
      </span>
    </label>
    <div class="control-group {% if forms.article_form.publication_state.errors %}error{% endif %}">
      {{ forms.article_form.publication_state }}
    </div>

    <label for="{{ forms.article_form.publication_country.id }}">
      <span {% if 'required' in forms.article_form.publication_country.flags %}class="req-field"{% endif %}>
        {{ forms.article_form.publication_country.label }}
      </span>
    </label>
    <div class="control-group {% if forms.article_form.publication_country.errors %}error{% endif %}">
      {{ forms.article_form.publication_country }}
    </div>

    <label for="{{ forms.article_form.doctopic.id }}">
      <span {% if 'required' in forms.article_form.doctopic.flags %}class="req-field"{% endif %}>
        {{ forms.article_form.doctopic.label }}
      </span>
    </label>
    <div class="control-group {% if forms.article_form.doctopic.errors %}error{% endif %}">
      {{ forms.article_form.doctopic }}
    </div>

    <label for="{{ forms.article_form.bibliographic_standard.id }}">
      <span {% if 'required' in forms.article_form.bibliographic_standard.flags %}class="req-field"{% endif %}>
        {{ forms.article_form.bibliographic_standard.label }}
      </span>
    </label>
    <div class="control-group {% if forms.article_form.bibliographic_standard.errors %}error{% endif %}">
      {{ forms.article_form.bibliographic_standard }}
    </div>

    <label for="{{ forms.article_form.sponsor.id }}">
      <span {% if 'required' in forms.article_form.sponsor.flags %}class="req-field"{% endif %}>
        {{ forms.article_form.sponsor.label }}
      </span>
    </label>
    <div class="control-group {% if forms.article_form.sponsor.errors %}error{% endif %}">
      {{ forms.article_form.sponsor }}
    </div>

    <label for="{{ forms.article_form.type_literature.id }}">
      <span {% if 'required' in forms.article_form.type_literature.flags %}class="req-field"{% endif %}>
        {{ forms.article_form.type_literature.label }}
      </span>
    </label>
    <div class="control-group {% if forms.article_form.type_literature.errors %}error{% endif %}">
      {{ forms.article_form.type_literature }}
    </div>

    <div class="control-group {% if forms.abstract_formset.errors %}error{% endif %}">
      <table id="abstractformset" class="table table-bordered table-striped">
        <tr>
          <td>{% trans 'Abstract' %}</td>
          <td>{% trans 'Language'%}</td>
        </tr>
        {% for abstract in forms.abstract_formset %}
        <tr>
          <td>
            {{ abstract.abstract }}
          </td>
          <td>{{ abstract.language }}</td>
        </tr>
        {% endfor %}
      </table>
      <p>
        {{ forms.abstract_formset.management_form }}
      </p>
    </div>

  </div>

  <span class="label">{% trans "Dates" %}</span>
  <div class="well">
    <div class="control-group {% if forms.dates_formset.errors %}error{% endif %}">
      <table id="datesformset" class="table table-bordered table-striped">
        <tr>
          <td>{% trans 'Thesis' %}</td>
          <td>{% trans 'Conference'%}</td>
          <td>{% trans 'Publication'%}</td>
          <td>{% trans 'Revision'%}</td>
        </tr>
        {% for date in forms.dates_formset %}
        <tr>
          <td>{{ date.thesis }}</td>
          <td>{{ date.conference }}</td>
          <td>{{ date.publication }}</td>
          <td>{{ date.revision }}</td>
        </tr>
        {% endfor %}
      </table>
      <p>
        {{ forms.dates_formset.management_form }}
      </p>
    </div>
  </div>

  <span class="label">{% trans "Pages" %}</span>
  <div class="well">
    <div class="control-group {% if forms.article_form.errors %}error{% endif %}">
      <label for="{{ forms.article_form.first_page.auto_id }}">
        <span {% if forms.article_form.first_page.field.required %}class="req-field"{% endif %}>
          {% trans forms.article_form.first_page.label %}
        </span>
      </label>
      <div class="controls">
        {{ forms.article_form.first_page }}
      </div>

      <label for="{{ forms.article_form.last_page.auto_id }}">
        <span {% if forms.article_form.last_page.field.required %}class="req-field"{% endif %}>
          {% trans forms.article_form.last_page.label %}
        </span>
      </label>
      <div class="controls">
        {{ forms.article_form.last_page }}
      </div>
    </div>
  </div>
  <span class="label">{% trans "Analytical Authors" %}</span>

  <div class="well">
    <div class="control-group {% if forms.analytical_formset.errors %}error{% endif %}">
      <table id="analyticalauthorsformset" class="table table-bordered table-striped">
        <tr>
          <td>{% trans 'Firstname' %}</td>
          <td>{% trans 'Lastname' %}</td>
          <td>{% trans 'Role' %}</td>
        </tr>
        {% for a_author in forms.analytical_formset %}
        <tr>
          <td>{{ a_author.firstname }}</td>
          <td>{{ a_author.lastname }}</td>
          <td>{{ a_author.role }}</td>
        </tr>
        {% endfor %}
      </table>
      <p>
        {{ forms.analytical_formset.management_form }}
      </p>
    </div>
  </div>

  <div class="row-fluid">
    <input class="btn btn-primary"
    name="submit"
    type="submit"
    value="{% trans "save" %}"/>
    <input class="btn btn-warning"
    type="reset"
    value="{% trans "cancel" %}"/>
  </div>
</form>
{% endblock %}

{% block extrafooter %}
{{ block.super }}
<script>
$(document).ready(function() {
  $('#titlesformset tbody tr').formset({
      formCssClass: 'dynamic-titleformset-form',
      prefix: '{{ forms.title_formset.prefix }}'
    });
  $('#abstractformset tbody tr').formset({
      formCssClass: 'dynamic-abstractformset-form',
      prefix: '{{ forms.abstract_formset.prefix }}'
    });
  $('#pagesformset tbody tr').formset({
      formCssClass: 'dynamic-pagesformset-form',
      prefix: '{{ forms.pages_formset.prefix }}'
    });
  $('#analyticalauthorsformset tbody tr').formset({
      formCssClass: 'dynamic-analyticalauthorsformset-form',
      prefix: '{{ forms.analytical_formset.prefix }}'
    });
});
</script>
{% endblock %}